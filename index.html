<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta name="description" content="An Online IDE for the Coq Theorem Prover" />

    <link rel="stylesheet" type="text/css" href="jscoq-buidls/node_modules/bootstrap/dist/css/bootstrap.min.css">

    <title>Use Coq in Your Browser: The Js Coq Theorem Prover Online IDE!</title>
  </head>

<body>
  <div id="ide-wrapper" class="toggled">
  <div id="code-wrapper">
  <div id="document">
  <div>
		<h1>項書換による証明付き最適化</h1>
		<h2>池渕未来 MIT</h2>
  <div>
		<textarea id="initial">
From Coq Require Import Init.Prelude.
From Coq Require Import List.
Import ListNotations.
Set Implicit Arguments.

Ltac optimize db :=
  eexists; intros;
  match goal with
    |- ?X = ?Y =>
    let P := fresh in
    set (P := fun y => y = Y);
    enough (P X) by auto
  end;
  repeat autounfold with db;
  autorewrite with db;
  reflexivity.</textarea>
	</di
	<div>
		<h2>内容</h2>
	</div>	
  <div>
		<h2>例</h2>
		<textarea id="list_ex">
Definition sqr_list xs := map (fun x => x * x) xs.
Definition sqr_add2_list xs :=
	map (fun x => x + 2) (sqr_list xs).</textarea>
		<p>map関数が二重になっていて，リストを二回走査する分効率が少し悪い</p>
		<textarea id="list_ex_sig">
Hint Rewrite map_map : my_db.
Hint Unfold sqr_list sqr_add2_list : my_db.

Definition sa_optimized_sig :
	{ f | forall xs, sqr_add2_list xs = f xs } :=
	ltac:(optimize my_db).
		</textarea>

  </div> <!-- panel-heading -->
  </div> <!-- /#panel body -->
  </div> <!-- /#document -->
  </div> <!-- /#code-wrapper -->
  </div> <!-- /#ide-wrapper -->

  <script src="jscoq-builds/ui-js/jscoq-loader.js" type="text/javascript"></script>
  <script type="text/javascript">

    var jscoq_ids  = ['initial', 'list_ex', 'list_ex_sig' ];
    var jscoq_opts = {
        prelude:   false,
        implicit_libs: false,
        base_path: 'jscoq-builds/',
        editor: { keyMap: 'default' },
				theme: 'light',
        init_pkgs: ['init'],
        all_pkgs:  ['init', 'stdpp',
                    'coq-base', 'coq-collections', 'coq-arith', 'coq-reals', 'lf', 'plf']
    };

    /* Global reference */
    var coq;

    loadJsCoq(jscoq_opts.base_path)
        .then( () => coq = new CoqManager(jscoq_ids, jscoq_opts) );
  </script>
</body>
</html>
